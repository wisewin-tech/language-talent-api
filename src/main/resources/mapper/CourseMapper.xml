<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 【用户】 -->
<mapper namespace="com.wisewin.api.dao.CourseDAO">

    <!--热门课程-->
    <select id="getHotCourse" parameterType="java.util.Map" resultType="com.wisewin.api.entity.bo.CourseBO">
       SELECT
	    `language`.language_name,
	    `language`.thumbnail_image_url,
	    course.course_name,
	    course.course_intro,
	    course.certificate_or_not,
	    course.id
      FROM
	    lt_course `course`
      JOIN lt_language `language` ON course.language_id = `language`.id
      WHERE course.hot_or_not = 'yes'
		<include refid="limit" />
    </select>
	<sql id="limit">
		limit #{pageOffset},#{pageSize}
	</sql>

    <!--课程详情页-->
    <select id="courseDetails" parameterType="com.wisewin.api.entity.bo.CourseBO" resultType="com.wisewin.api.entity.bo.CourseBO">
        SELECT
			`language`.language_name languageName,
			course.thumbnail_image_url courseThumbnail,
			course.course_name,course.course_intro,
			course.certificate_or_not,course.certificate_title certificateTitle,
			course.certificate_image_url certificateImageUrl,
			course.certificate_intro certificateIntro,
			`level`.level_name levelName,`level`.id levelId,
			course.course_lightspot,course.purchase_notes,
			course.price,course.discount_price,course.id
		FROM
			lt_course `course`
		LEFT JOIN lt_language `language` ON course.language_id = `language`.id
		LEFT JOIN lt_level `level` ON course.id = `level`.course_id
		WHERE
			course.`status` = 'putaway' AND course.id = #{id}
    </select>
	<!--搜索课程-->
	<select id="courseSearch" parameterType="java.lang.String" resultType="com.wisewin.api.entity.bo.CourseBO">
		SELECT
			`language`.language_name,course.course_name,
			course.course_intro,course.thumbnail_image_url,
			course.certificate_or_not,course.id courseId
		FROM lt_course `course`
		LEFT JOIN lt_language `language` ON course.language_id = `language`.id
		<where>
			`language`.language_name LIKE concat('%',#{languageName},'%')
			AND course.`status`='putaway'
		</where>
	</select>
</mapper>